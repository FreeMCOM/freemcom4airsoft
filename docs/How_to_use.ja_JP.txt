・これは何？
	サバゲ・ペイントボール、あるいは雪合戦等で、Battlefield(R)シリーズの"ラッシュ"に準じたルールで遊ぶための、Arduinoを使用した、"M-COM"のフリー実装です。

・必要なもの
	Arduino (リレーシールドとの兼ね合い上、Arduino Uno/Leonard等、標準サイズ推奨。)
	Arduino IDE(http://www.arduino.cc/)
	大音量のブザー
	LED赤色灯
	押ボタンスイッチ(モーメンタリ)　×1 (起動/解除用)
	タクトスイッチ ×1 (リセットボタン用)
	リレーシールド (SLD01101P推奨)
	電源 (Arduino用と、LED赤色灯・ブザー用の2系統が必要)

	以下の物は遠隔監視を行う場合に必要となります。
		PC
		python 2.7系統
		python2.7用のwxPython
		pyserial2.7

		加えて、XBee ATモードでの監視を行う場合、以下の物が追加で必要になります。
			XBee ×2 (モデルにより外部アンテナも必要)
			Xbee エクスプローラ ×1
			Arduino ワイヤレスプロトシールド ×1
			


・セットアップ
	0:(お好みで)26行〜29行辺りのグローバルな変数・定数を変更します。

	これは、struct TIMER { const long LIMIT , const long STEP , long TIME  }  という構造体になっています。

		struct TIMER STAGE1_DEFAULT = {5, 2, 20} ;		//ステージ1(ゆっくり点滅)のLIMIT, STEP, TIME
		struct TIMER STAGE2_DEFAULT = {2, 1, 10} ;		//ステージ2(早く点滅)のLIMIT, STEP, TIME
		struct TIMER ENGAGE_DEFFAULT = {1, 1, 5};		//MCOM起動のLIMIT, STEP, TIME
		struct TIMER DISENGAGE_DEFAULT = {10, 1, 5};	//MCOM解除のLIMIT, STEP, TIME

		LIMITは長押し時間・各ステージの最低時間を指しております。
		STEPはMCOM解除毎にどれだけTIME(後述)を増減するかを表しております。
			なお、正の値だと各ステージ及び起動長押しは解除毎にSTEP秒短くなり、解除長押しは長くなるようになっています。		
		TIMEはそれぞれの長押し時間・各ステージの継続時間です。


	1:freemcom.inoをarduinoに焼きます
	2:SW_PIN(2番ピン)を起動/解除用押ボタンに接続します。(このスイッチはケース表面から押せる所に設置)
	3:リレーを使用して、BUZZER_PIN(NO2)を大音量ブザーに接続します。
	4:リレーを使用して、LED_PIN(NO1)を赤色灯に接続します。
	5:Arudino UNOの場合リセットピンをGNDに落とすとリセットされるので、押ボタンスイッチを介してGNDに落とせるようにする。このスイッチはケース内等、容易に押せない場所に設置してください。

	Fritzing形式の回路図はfreemcom.fzz , png形式の回路図はfreemcom_circuit.pngです。


・遠隔監視の行い方
	下準備:
		X-CTUで各々のXBeeの初期設定を行う
		・双方のXBeeモジュールに通信相手の固有IDを入力、PAN IDを書き込む
		・(シリーズ2のみ)PC側を「Coodinator AT」に、MCOM側を「Router AT」に設定する。
		詳細は以下を参照して頂ければ、と思います。
			http://mag.switch-science.com/2012/07/20/startup_xbee_s1/ (スイッチサイエンス社の解説。シリーズ1)
			http://mag.switch-science.com/2012/08/01/startup_xbee_zb/ (スイッチサイエンス社の解説。シリーズ2)

		・Arduinoにリレーシールドを乗せ、その上に赤色灯とブザーを接続したワイヤレスプロトシールドを乗せ、最後にMCOM側のXBeeを乗せる
		・XBeeエクスプローラにPC側XBeeを乗せ、USB端子に接続する

	1:monitor/monitor.py の冒頭にある、「port_default」 の値をXBeeエクスプローラを接続したポートに書き換える(or コマンドライン引数でXBeeエクスプローラを接続したポートを指定する)
	2:「起動まで　5　秒長押し」と表示されたのを確認後、ゲームを開始してください。(スケッチのENGAGE_DEFAULTを変更していない&Arduinoの電源を入れて一度もM-COMを起動させていない場合。)
		2.1:「起動まで　　秒長押し」となって時間が表示されない場合、XBeeエクスプローラのリセットボタンをおしてください。
		22:それでも直らないなら、以下の項目を点検してください。
			・正しいポートを指定しているか(未使用ポートならば、"<ポート番号> が見つかりません。"と表示されますが、不運にも何らかの機器がそのポートを使用していた場合、正常に表示されないでしょう)。
			・Arduinoに正しくスケッチを書き込んでいるか(ArduinoにUSBケーブル経由でスケッチを書き込む場合、ワイヤレスプロトシールドのSERIAL SELECTスイッチをUSB側にしなければ正常に書き込みができません)。
			・各部配線の接続が確実か
			・ワイヤレスプロトシールドのSERIAL SELECTスイッチがMICRO側になっているか。
			・XBeeの設定が正しいか。 シリーズ2の場合CoodinatorとRouterを取り違えていないか。


・ゲームでの使い方
	0:ゲーム開始前にリセットボタンを押す
	1:起動/解除ボタンをENGAGE_TIMEで指定した時間押し続けると、断続的にブザーが鳴り、LEDが点滅を初めます。
	2:WAIT_TIMEが経過するとWARN_TIMEに入り、LED点滅サイクルとブザーの断続間隔が短くなります
	3:1〜2の間に起動/解除ボタンをDISENGAGE_TIMEで指定された時間押し続けると、ブザーが短く鳴る&LEDが2回点滅し、カウント開始前の状態に戻ります。
	3:WARN_TIMEが経過してしまうと、LEDが点灯し、同時に5秒間ブザーが鳴り続けて「フリーズ」します。(これ以降、起動/解除ボタンを押しても初期状態には戻せません)
	4:ゲームの勝敗が決する、あるいは時間切れでゲームが終了したら、リセットボタンを押して0の状態に戻してください。


・ユーザー向け提案事項
	・起動/解除用スイッチを、押しボタンスイッチ2つ直列に接続して「両手押しスイッチ」に変更すると、銃を片手で持ったまま起動/解除操作ができなくなりますので、チームワークがより重要になりゲーム性を大きく変える事ができるでしょう。


・ライセンス
	ライセンスはGNU GPL v3(以降の任意版)とします。ライセンスの全文はGPL-3.0をお読みください。
		(ライセンス全文より短いコードですが、「売り物」にされる事を考慮した上で、ユーザーによる改良を妨げない事を意図しGPLv3としています。もっとも、「売り物」にするには、ハードウェアのコストダウンが必須ですが・・・)

・著者情報
	Kiyohito AOKI(sambar.fgfs@gmail.com)
